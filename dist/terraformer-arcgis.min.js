/*! Terraformer JS - 2.0.0alpha1 - 2012-11-20
*   https://github.com/geoloqi/Terraformer
*   Copyright (c) 2012 Environmental Systems Research Institute, Inc.
*   Licensed MIT */
(function(e,t){typeof define=="function"&&define.amd?define(t):e.Terraformer=t(),typeof jasmine=="object"&&(e.Terraformer=t())})(this,function(){function n(e){this.name=e,Object.freeze(this)}var e={};e.config={stringifyGeoJSON:!1,returnFeatures:!1,outputSpatialReference:{wkid:102100}};var t=function(t){if(t.coordinates&&t.type){if(t.type==="Point")return e.Types.POINT;if(t.type==="LineString")return e.Types.LINE;if(t.type==="Polygon")return e.Types.POLYGON;if(t.type==="MultiPoint")return e.Types.MULTIPOINT;if(t.type==="MultiLineString")return e.Types.MULTILINE;if(t.type==="MultiPolygon")return e.Types.MULTIPOLYGON;if(t.type==="Feature")return e.Types.FEATURE;throw"Terraformer: invalid GeoJSON object. Are you sure your data is properly formatted?"}if(t.spatialReference){if(t.x&&t.y)return e.Types.POINT;if(t.points)return e.Types.MULTIPOINT;if(t.paths)return t.paths.length===1?e.Types.LINE:e.Types.MULTILINE;if(t.rings)return t.rings.length===1?e.Types.POLYGON:e.Types.MULTIPOLYGON;throw"Terraformer: invalid ArcGIS input. Are you sure your data is properly formatted?"}throw"Terraformer: data is not a valid ArcGIS or GeoJSON object"};return e.toGeoJSON=function(n,r){var i=typeof r=="undefined"?{}:r,s=t(n),o=i.stringify?i.stringify:e.config.stringifyGeoJSON,u=i.feature?i.feature:e.config.returnFeatures,a;if(n.spatialReference.wkid===102100)n=esri.geometry.geographicToWebMercator(n);else if(n.spatialReference.wkid!==4326)throw"Terraformer: cannot use a spatial reference system other then web mercator or geographic";switch(s){case e.Types.POINT:a={type:"Point",coordinates:[n.x,n.y]};break;case e.Types.MULTIPOINT:a={type:"MultiPoint",coordinates:n.points};break;case e.Types.LINE:a={type:"LineString",coordinates:n.paths[0]};break;case e.Types.MULTILINE:a={type:"MultiLineString",coordinates:n.paths};break;case e.Types.POLYGON:a={type:"Polygon",coordinates:n.rings[0]};break;case e.Types.MULTIPOLYGON:a={type:"MultiPolygon",coordinates:n.rings}}return u&&(a={type:"Feature",bbox:[n.extent.xmin,n.extent.ymin,n.extent.xmax,n.extent.ymax],geometry:a}),o?JSON.stringify(a):a},e.toArcGIS=function(n,r){var i=typeof r=="undefined"?{}:r,s=new esri.SpatialReference(4326),o=i.spatialReference?i.spatialReference:e.config.outputSpatialReference,u=t(n),a;u===e.Types.FEATURE&&(n=n.geometry,u=t(n));if(o.wkid!==4326&&o.wkid!==102100)throw"Terraformer: cannot use a spatial reference system other then web mercator or geographic";switch(u){case e.Types.POINT:a=new esri.geometry.Point({x:n.coordinates[0],y:n.coordinates[1],spatialReference:s});break;case e.Types.MULTIPOINT:a=new esri.geometry.Multipoint({points:n.coordinates,spatialReference:s});break;case e.Types.LINE:a=new esri.geometry.Polyline({paths:[n.coordinates],spatialReference:s});break;case e.Types.MULTILINE:a=new esri.geometry.Polyline({paths:n.coordinates,spatialReference:s});break;case e.Types.POLYGON:a=new esri.geometry.Polygon({rings:[n.coordinates],spatialReference:s});break;case e.Types.MULTIPOLYGON:a=new esri.geometry.Polygon({rings:n.coordinates,spatialReference:s})}return o.wkid===102100?esri.geometry.geographicToWebMercator(a):a},n.prototype=Object.create(null),n.prototype.constructor=n,n.prototype.toString=function(){return"|"+this.name+"|"},Object.freeze(n.prototype),Enum=function(e){Array.prototype.forEach.call(arguments,function(e){this[e]=new n(e)},this),Object.freeze(this)},Enum.prototype.symbols=function(){return Object.keys(this).map(function(e){return this[e]},this)},Enum.prototype.contains=function(e){return!e instanceof n?!1:this[e.name]===e},Enum.prototype.find=function(e){if(this[e])return this[e];if(this[e.name])return this[e.name]},e.Types=new Enum("POINT","LINE","POLYGON","MULTIPOINT","MULTILINE","MULTIPOLYGON","FEATURE"),e});